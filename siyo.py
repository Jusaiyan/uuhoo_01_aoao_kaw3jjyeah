import streamlit as st

def siyo():
    st.title("表示項目と算出方法の説明")

    st.markdown("""
    以下はアプリが **何を表示しているか** と **その数字がどう算出され、何を意味するか** の説明です。  
    購入判断の前提（**現物で買う**）を念頭に、現金準備に直結する情報も含めています。
    """)

    st.header("表示項目一覧（アプリ上の日本語カラム名）")

    st.subheader("銘柄")
    st.write("JPX の銘柄コード（.T を外した形）。これが投資対象です。")

    st.subheader("シグナル日")
    st.write("アプリが「買いシグナル（初動サイン）」を検出した日。最新のシグナル日を示します（過去シグナルだった場合は注記）。")

    st.subheader("終了日終値")
    st.write("""
    指定した終了日（ユーザー入力）の調整終値 (Adj Close)。  
    現物購入の基準価格として使います（手数料・税・スリッページは含まず）。  
    最低限その価格 × 希望株数 の現金が必要です。
    """)

    st.subheader("想定購入額(1株) / (100株)")
    st.write("""
    終値を基にした購入金額。  
    例: 終値が 2,500 円 → 1株: 2,500 円 / 100株: 250,000 円（手数料等別）。
    """)

    st.subheader("対象期間騰落率")
    st.write("指定した「開始日 → 終了日」の騰落率（%）。期間中のパフォーマンス指標です。")

    st.subheader("EMA21")
    st.write("Adj Close を基に算出した 21 期間指数移動平均 (EMA) の値。反発の有無を確認します。")

    st.subheader("ピボット高値(直前)")
    st.write("過去 pivot_lookback 日（デフォルト 40 日）の High の最大値（当日を含めないシフト済み）。高値ブレイク判定に使用。")

    st.subheader("当日出来高 / 出来高20日平均")
    st.write("当日の出来高と直近20日の平均出来高。出来高はブレイク信頼度の評価に使用。")

    st.subheader("出来高急増?")
    st.write("当日の出来高が volume_multiplier × vol20（デフォルト1.5倍）を上回るか。")

    st.subheader("2週間最大騰落率（予測）")
    st.write("""
    シグナル日の翌日から test_days（デフォルト14営業日）以内の最高値に基づく最大上昇率。  
    過去データを使った参考値であり、将来を保証するものではありません。
    """)

    st.header("算出手順（要点）")
    st.write("""
    1. yfinance で指定期間の全銘柄データを取得（Adj Close, Open, High, Low, Volume）。
    2. 各銘柄ごとに EMA21 計算、反発判定、ピボット高値突破判定、出来高急増判定を実施。
    3. **買いシグナル条件**：rebound_start AND pivot_break AND volume_spike。
    4. シグナル日から test_days 日以内の最高値で2週間最大騰落率（予測）を算出。
    """)

    st.header("このデータの使い方（現物購入の観点）")
    st.write("""
    - **終了日終値 と 想定購入額(100株)** → 必要最低現金額の目安。
    - **出来高急増 + ピボットブレイク** → 短期値動きの可能性あり（リスクも高い）。
    - **2週間最大騰落率（予測）** → 過去傾向の参考値（必ず板状況やニュース確認）。
    """)

    st.header("注意点（重要）")
    st.write("""
    - シグナルは確率的であり、ダマシも存在。必ず板や日中足を確認。  
    - 手数料・税は表示していない。実際は「想定購入額 + 手数料 + 予備資金」が必要。  
    - 過去データは未来を保証しない。  
    - 銘柄数が多い場合、処理時間が長くなる可能性あり（Streamlit Cloud 制限に注意）。
    """)


